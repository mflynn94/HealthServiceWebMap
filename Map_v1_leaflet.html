<!DOCTYPE html>
<!–– -->
<html>

<head>
    <title>Health Service Finder</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.css" />
    <link href='https://api.mapbox.com/mapbox-gl-js/v1.11.0/mapbox-gl.css' rel='stylesheet' />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/themes/base/jquery-ui.css" type="text/css" media="all" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-geosearch@3.0.0/dist/geosearch.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
    
    <link rel="stylesheet" href="Plugins/leaflet-sidebar/src/L.Control.Sidebar.css" />
    <!--<link rel="stylesheet" href="Plugins/Leaflet.EasyButton/src/easy-button.js" />-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">

    <style>
        body { margin:10; padding:10; }
        
        
        #map { position:absolute; top:0; bottom:0; left:0; width: 100%; }
        .custom .leaflet-popup-tip,
        .custom .leaflet-popup-content-wrapper {
            background: #ffffff;
            opacity: 1;
            color: #09325C;
        }

        .box{
            width:100%;
            
            background:#09325C;
            opacity: 0.8;
        }
        .top {
            height:8%;
        }
        .bottom{
            position: absolute;
            bottom: 1%;
            height:80px;
            width: 90%;
        }

        .line{
            width: 100%;
            height:0.1%;
            background:#09325C;
            opacity: 0.5;
        }

        .btn {
            position: relative;
            background-color: #fff;
            border-style: solid;
            border-width: 1px;
            border-color: #09325C;
            color: #09325C;
            padding: 10px 20px;
            cursor: pointer;
            width: 80%;
            left: 10%;
            right: 10%;
            height: 5%;
            margin-bottom:10px;
            opacity: 0.8;
            vertical-align: middle;
            font-weight: bold;
            font-size: 15px;
            font-family: Helvetica;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);
            }

    </style>
</head>

<body>
    
    <div id="map"></div>

    <div id="sidebar">
    
    </div>

    <!–– Reference all sources -->

    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v0.46.0/mapbox-gl.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.1/leaflet.js"></script>
    <script src="https://rawgit.com/mapbox/mapbox-gl-leaflet/master/leaflet-mapbox-gl.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js" type="text/javascript"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script src="https://unpkg.com/leaflet-geosearch@3.0.0/dist/geosearch.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    
    <script src="Plugins/leaflet-sidebar/src/L.Control.Sidebar.js"></script>
    <!--<script src="Plugins/Leaflet.EasyButton/src/easy-button.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>


    <script src="Plugins/html2pdf.js/html2pdf.bundle.min.js"></script>
    <script src="2020_07_07_Processed_Pharmacies.js"></script>
    <script src="2020_07_07_Processed_Dentists.js"></script>
    <script src="2020_07_07_Processed_GPs.js"></script>
    <script src="2020_07_07_Processed_Hospitals.js"></script>
    <script src="2020_07_07_Processed_Opticians.js"></script>
    <script src="2020_07_07_Processed_SHClinics.js"></script>
    <script src="mappolygon.js"></script>
    <!–– Script for map containing javascript code begins -->

    <script>




    // Establish base map using Ordnance Survey Zoomstack, and Mapbox-GL-Leaflet plugin

    var basemapLayers = L.layerGroup();

    var light_basemap = L.mapboxGL({
    style: 'https://s3-eu-west-1.amazonaws.com/tiles.os.uk/v2/styles/open-zoomstack-light/style.json',
    accessToken: 'no-token'
    });

    var night_basemap = L.mapboxGL({
    style: 'https://s3-eu-west-1.amazonaws.com/tiles.os.uk/v2/styles/open-zoomstack-night/style.json',
    accessToken: 'no-token'
    })

    var outdoor_basemap = L.mapboxGL({
    style: 'https://s3-eu-west-1.amazonaws.com/tiles.os.uk/v2/styles/open-zoomstack-outdoor/style.json',
    accessToken: 'no-token'
    })

    var roads_basemap = L.mapboxGL({
    style: 'https://s3-eu-west-1.amazonaws.com/tiles.os.uk/v2/styles/open-zoomstack-road/style.json',
    accessToken: 'no-token'
    })

    // store base maps in group
    var baseMaps = {
        "Light": light_basemap,
        "Night": night_basemap,
        "Outdoors": outdoor_basemap,
        "Road" : roads_basemap
    };

    // store each service in layer group
    var Opticians_layer = L.layerGroup(),
        GPs_layer = L.layerGroup(),
        Dentists_layer = L.layerGroup(),
        SHClinics_layer = L.layerGroup(),
        Pharmacies_layer = L.layerGroup(),
        Hospitals_layer = L.layerGroup();

    // initialise map with max and min zoom, max bounds and the default basemap layer
    var map = L.map('map', {
    minZoom: 7,
    maxZoom: 18,
    maxBounds: [[ 49.84 , -8.74 ], [ 60.9, 1.96 ]],
    layers: [outdoor_basemap]
    });

    // set the initial view of the map to Glasgow area
    map.setView([ 55.8652, -4.45 ], 10);

    // Add a search bar to the map
    L.Control.geocoder({
        position: 'topleft'
    }).addTo(map);

    // add zoom control to the map
    map.zoomControl.setPosition('bottomright');

    // add attribution to the map
    map.attributionControl.addAttribution('Contains OS data &copy; Crown copyright and database rights 2018');

    // add sidebar to the map. Ensure it has a close button, appears on the left hand side, and 
    // is shown on map start up.
    
    var sidebar = L.control.sidebar('sidebar', {
        closeButton: true,
        position: 'left',
        autopan: false,
        }).addTo(map);
    
        setTimeout(function () {
            sidebar.show();
            sidebar.setContent("<div class = 'box top'></div> \
        <h1>Find your local Health Services \
        </h1>\
        <h4>Welcome to a new and engaging way to search for your nearest NHS Scotland Health Services.</h4>\
        <p>Whether you are looking for a GP, Dentist, Optician, Pharmacy, Hospital or Sexual Health Service, you can find the address and contact details of the ones closest to you.</p>\
        <p> Please choose the service you are looking for today. You can then hover to view the name and telephone number of each location, or click to see extra details. </p>\
        <br>\
        <button type='button' class=btn onclick='addLayer(GPs_layer)'>GPs</button>\
        <br>\
        <button type='button' class=btn onclick='addLayer(Dentists_layer)'>Dentists</button>\
        <br>\
        <button type='button' class=btn onclick='addLayer(Opticians_layer)>Opticians</button>\
        <br>\
        <button type='button' class=btn onclick='addLayer(Pharmacies_Layer)'>Pharmacies</button>\
        <br>\
        <button type='button' class=btn onclick='addLayer(Hospitals_layer)'>Hospitals</button>\
        <br>\
        <button type='button' class=btn onclick='addLayer(SHClinics_layer)''>Sexual Health Service</button>\
        <br><br>\
        <div class = 'box bottom'></div>\
        </div>")
            }, 500)     

    // add user location control to the map
    var lc = L.control.locate({
        options: {
            circleStyle: {
                fillOpacity: 0
            },
            keepCurrentZoomLevel: true,
            flyTo: true
        }
    }).addTo(map);

      // ask user location on map load
     // lc.start();

    // store user coordinates
    function onLocationfound(e) {
        var user_location = e.latlng;
        console.log(user_location);
    }


    map.on('locationfound', onLocationfound);

  

    // load polygon on the map and grey out areas around Greater Glasgow and Clyde
    /*var map_poly = L.geoJSON(mappolygons, {
        style: {
            "color": "#808080",
            "weight": 0,
            "fill": true
        }
    }).addTo(map);*/

    // create custom options for pop up information
    var customOptions =
            {
            'maxWidth': '200',
            'className' : 'custom'
            }

    

    /*
    // create a function for styling points and adding them to the map
    function addPoints(service, layerName, figureURL, popup_list) {
        
        // add icons for the services and style them appropriately
        var mapIcon = L.icon({
            iconUrl: figureURL,
            iconSize: [30, 30],
            iconAnchor: [15,15],
            popupAnchor: [0, -15],
        });

        // add the geoJSON files to the defined layer groups and run the on each feature function
        L.geoJSON(service, {
            onEachFeature: onEachFeature,
            pointToLayer: function (feature, latlng) {
                return L.marker(latlng, {icon: mapIcon});
            }
        }).addTo(layerName);
    }*/

    
    // create a function for styling points and adding them to the map
    function addIcon(figureURL) {
        // add icons for the services and style them appropriately
        var mapIcon = L.icon({
            iconUrl: figureURL,
            iconSize: [30, 30],
            iconAnchor: [15,15],
            popupAnchor: [0, -15],
        });
    }



   
    
    // add a button control for toggling the sidebar on and off
    L.easyButton("fa fa-info-circle", function(btn, map){
        sidebar.toggle();
        sidebar.setContent("<div class = 'box top'></div><h1>Scotland Health Service Finder</h1><h4>Welcome to a new and engaging way to search for your nearest NHS Scotland Health Services.</h4><p>Whether you are looking for a GP, Dentist, Optician, Pharmacy, Hospital or Sexual Health Service, you can find the address and contact details of the ones closest to you.</p><p> Please begin by selecting an option within the legend. You can hover to view the name and telephone number of each location, or click to see extra details! </p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class = 'box bottom'></div></div>")
    }).addTo(map);


    function saveAsPDF() {
        
        var opt = {
            margin:       1,
            filename:     'MyLocalService.pdf',
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2 },
            jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
            };

        var element = document.getElementById('sidebar');
        console.log(element);
        var elementHTML = element.outerHTML;
        var element2 = elementHTML.replace("Save as PDF", '');
        
        html2pdf().set(opt).from(element2).save()
    }

    // add the GP data and set the sidebar and popup content 
    var GPInfo = L.geoJSON(GPs, {
        onEachFeature: function(feature, layer) {
            var fp = feature.properties;
            
            layer.on('click', function (e) {
                //sidebar.show();
                var Name = feature.properties.Name
                
                if (sidebar.isVisible() == true) {
                    $("#sidebar").hide().fadeIn('slow');
                } else {
                    sidebar.show();
                }
                
               sidebar.setContent(
                    "<div class = 'box top'></div><h2>" + 
                    fp.Name + 
                    "</h2><div class ='line'></div><b><br>Address<br></b>" + 
                    feature.properties.Address1 + 
                    "<br>" + 
                    fp.Postcode + 
                    "<br><br><div class ='line'></div><br>" 
                    + "<b>Telephone</b><br> <a href=tel:" + ((fp.Telephone).replace(/\s+/g, ''))+ ">" + fp.Telephone+"</a><br><br>" +
                    "<div class ='line'></div><br><b>Opening Times</b>"+
                    "<br><br>Monday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + fp.Monday + 
                    "<br>Tuesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + fp.Tuesday + 
                    "<br>Wednesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + fp.Wednesday + 
                    "<br>Thursday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + fp.Thursday + 
                    "<br>Friday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + fp.Friday + 
                    "<br><br><br>" +
                    "<div class ='line'></div><br>"+
                    "<a href=" + fp.Website + " target=_blank>Visit Website</a>"  + 
                    "<br><br><div class ='line'></div><br>"+
                    "<a href=https://www.google.com/maps/dir//" + ((fp.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a>" +
                    "<br><br><div class ='line'></div>" +
                    "<br><a href='#sidebar' <span onClick='saveAsPDF()' >Save as PDF</span></a>" +
                    "<br><br><div class = 'box bottom'></div><h2><br><br>"
                )
                 
            });
            

            layer.bindPopup("<h4>"+ fp.Name + "</h4>" + fp.Address1 + "<br>" + fp.Postcode + "<br><a href=tel:"
            + fp.Telephone+ ">" + fp.Telephone + "</a><br><br>Click for more info" , customOptions);

            layer.on('mouseover', function () {
                this.openPopup()
            });
        },

            pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/GPs.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(GPs_layer);
    
    
    
    // add the Dentists data and set the sidebar and popup content

    L.geoJSON(Dentists, {
        onEachFeature: function(feature, layer) {
            layer.on('click', function (e) {
            
            sidebar.show();
            sidebar.setContent("<div class = 'box top'></div><h2>"+ feature.properties.Name + "</h2><div class ='line'></div><b><br>Address<br></b>" + feature.properties.Address1 + 
        "<br>" + feature.properties.Postcode + "<br><br><div class ='line'></div><br>" + "<b>Telephone</b><br> <a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone+"</a><br><br><div class ='line'></div><br><b>Opening Times</b><br><br>Monday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + 
        feature.properties.Monday + "<br>Tuesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Tuesday + "<br>Wednesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Wednesday + 
        "<br>Thursday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Thursday + "<br>Friday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Friday + "<br> " 
        + "<br><br><div class ='line'></div><br><a href=" + feature.properties.Website + " target=_blank>Visit Website</a>"  + "<br><br><div class ='line'></div><br><a href=https://www.google.com/maps/dir//" 
        + ((feature.properties.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a><br><br><br><br><br><br><br><div class = 'box bottom'></div>");
        });
        
        layer.bindPopup("<h4>"+ feature.properties.Name + "</h4>" + feature.properties.Address1 + "<br>" + feature.properties.Postcode + "<br><a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone + "</a><br><br>Click for more info" , customOptions);

        layer.on('mouseover', function () {
            this.openPopup()
        });
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/Dentists.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(Dentists_layer);

    L.geoJSON(Opticians, {
        onEachFeature: function(feature, layer) {
            layer.on('click', function (e) {
            
            sidebar.show();
            sidebar.setContent("<div class = 'box top'></div><h2>"+ feature.properties.Name + "</h2><div class ='line'></div><b><br>Address<br></b>" + feature.properties.Address1 + 
        "<br>" + feature.properties.Postcode + "<br><br><div class ='line'></div><br>" + "<b>Telephone</b><br> <a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone+"</a><br><br><div class ='line'></div><br><b>Opening Times</b><br><br>Monday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + 
        feature.properties.Monday + "<br>Tuesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Tuesday + "<br>Wednesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Wednesday + 
        "<br>Thursday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Thursday + "<br>Friday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Friday + "<br> " 
        + "<br><br><div class ='line'></div><br><a href=" + feature.properties.Website + " target=_blank>Visit Website</a>"  + "<br><br><div class ='line'></div><br><a href=https://www.google.com/maps/dir//" 
        + ((feature.properties.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a><br><br><br><br><br><br><br><div class = 'box bottom'></div>");
        });
        
        layer.bindPopup("<h4>"+ feature.properties.Name + "</h4>" + feature.properties.Address1 + "<br>" + feature.properties.Postcode + "<br><a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone + "</a><br><br>Click for more info" , customOptions);

        layer.on('mouseover', function () {
            this.openPopup()
        });
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/Opticians.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(Opticians_layer);

    L.geoJSON(Pharmacies, {
        onEachFeature: function(feature, layer) {
            layer.on('click', function (e) {
            
            sidebar.show();
            sidebar.setContent("<div class = 'box top'></div><h2>"+ feature.properties.Name + "</h2><div class ='line'></div><b><br>Address<br></b>" + feature.properties.Address1 + 
        "<br>" + feature.properties.Postcode + "<br><br><div class ='line'></div><br>" + "<b>Telephone</b><br> <a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone+"</a><br><br><div class ='line'></div><br><b>Opening Times</b><br><br>Monday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + 
        feature.properties.Monday + "<br>Tuesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Tuesday + "<br>Wednesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Wednesday + 
        "<br>Thursday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Thursday + "<br>Friday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Friday + "<br> " 
        + "<br><br><div class ='line'></div><br><a href=" + feature.properties.Website + " target=_blank>Visit Website</a>"  + "<br><br><div class ='line'></div><br><a href=https://www.google.com/maps/dir//" 
        + ((feature.properties.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a><br><br><br><br><br><br><br><div class = 'box bottom'></div>");
        });
        
        layer.bindPopup("<h4>"+ feature.properties.Name + "</h4>" + feature.properties.Address1 + "<br>" + feature.properties.Postcode + "<br><a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone + "</a><br><br>Click for more info" , customOptions);

        layer.on('mouseover', function () {
            this.openPopup()
        });
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/Pharmacies.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(Pharmacies_layer);

    L.geoJSON(Hospitals, {
        onEachFeature: function(feature, layer) {
            layer.on('click', function (e) {
            
            sidebar.show();
            sidebar.setContent("<div class = 'box top'></div><h2>"+ feature.properties.Name + "</h2><div class ='line'></div><b><br>Address<br></b>" + feature.properties.Address1 + 
        "<br>" + feature.properties.Postcode + "<br><br><div class ='line'></div><br>" + "<b>Telephone</b><br> <a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone+"</a><br><br><div class ='line'></div><br><a href=" + feature.properties.Website + " target=_blank>Visit Website</a>"  + "<br><br><div class ='line'></div><br><a href=https://www.google.com/maps/dir//" 
        + ((feature.properties.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a><br><br><br><br><br><br><br><div class = 'box bottom'></div>");
        });
        
        layer.bindPopup("<h4>"+ feature.properties.Name + "</h4>" + feature.properties.Address1 + "<br>" + feature.properties.Postcode + "<br><a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone + "</a><br><br>Click for more info" , customOptions);

        layer.on('mouseover', function () {
            this.openPopup()
        });
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/Hospitals.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(Hospitals_layer);

    L.geoJSON(SHClinics, {
        onEachFeature: function(feature, layer) {
            layer.on('click', function (e) {
            
            sidebar.show();
            
            sidebar.setContent("<div class = 'box top'></div><h2>"+ feature.properties.Name + "</h2><div class ='line'></div><b><br>Address<br></b>" + feature.properties.Address1 + 
        "<br>" + feature.properties.Postcode + "<br><br><div class ='line'></div><br>" + "<b>Telephone</b><br> <a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone+"</a><br><br><div class ='line'></div><br><b>Opening Times</b><br><br>Monday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + 
        feature.properties.Monday + "<br>Tuesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Tuesday + "<br>Wednesday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Wednesday + 
        "<br>Thursday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Thursday + "<br>Friday: &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp" + feature.properties.Friday + "<br> " 
        + "<br><br><div class ='line'></div><br><a href=" + feature.properties.Website + " target=_blank>Visit Website</a>"  + "<br><br><div class ='line'></div><br><a href=https://www.google.com/maps/dir//" 
        + ((feature.properties.Postcode).replace(/\s+/g, '')) + " target=_blank>Get Directions</a><br><br><br><br><br><br><br><div class = 'box bottom'></div>");
        });
        
        layer.bindPopup("<h4>"+ feature.properties.Name + "</h4>" + feature.properties.Address1 + "<br>" + feature.properties.Postcode + "<br><a href=tel:"
        + feature.properties.Telephone+ ">" + feature.properties.Telephone + "</a><br><br>Click for more info" , customOptions);

        layer.on('mouseover', function () {
            this.openPopup()
        });
        },
        pointToLayer: function (feature, latlng) {
            return L.marker(latlng, {icon: L.icon({
                                            iconUrl: 'MapFigures/SHClinics.png',
                                            iconSize: [30, 30],
                                            iconAnchor: [15,15],
                                            popupAnchor: [0, -15]
            })
        });
        }
    }).addTo(SHClinics_layer);
    /*
    // run the add Points function for each service
    addPoints(Opticians, Opticians_layer, 'MapFigures/Opticians.png', ['Name', 'Address1', 'Monday', 'Tuesday'])
    addPoints(Dentists, Dentists_layer, 'MapFigures/Dentists.png')
    addPoints(GPs, GPs_layer, 'MapFigures/GPs.png')
    addPoints(Hospitals, Hospitals_layer, 'MapFigures/Hospitals.png')
    addPoints(Pharmacies, Pharmacies_layer, 'MapFigures/Pharmacies.png')
    addPoints(SHClinics, SHClinics_layer, 'MapFigures/SHClinics.png')
    */


    // store layers in overlay group
    var overlayMaps = {
        "GPs": GPs_layer,
        "Dentists" : Dentists_layer,
        "Pharmacies": Pharmacies_layer,
        "Opticians": Opticians_layer,
        "Hospitals": Hospitals_layer,
        "Sexual Health Clinics": SHClinics_layer
    };
        

    var pharmacyServices = {

    }

    var saturdayOpening = {
        "Open on Saturdays": 
    }
    // add a legend control for the overlay maps to allow users to swap between services 
    L.control.layers(overlayMaps).addTo(map);
    
    L.control.layers(baseMaps).addTo(map);

    // add responsive side bar to the map
    //var sidebar = L.control.sidebar('sidebar').addTo(map);
   
    
    function addLayer(layer) {
        sidebar.toggle();
        map.addLayer(layer)    
     };

     function addDentistsLayer() {
        map.removeLayer(GPs_layer);
        map.addLayer(Dentists_layer)    
     };

    </script>

    </body>
</html>